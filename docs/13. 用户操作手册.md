# 用户操作手册

## 1. 概述

本文档描述 Mysysenv 的使用方法，包括 GUI 和 CLI 两种方式。

## 2. 快速开始

### 2.1 安装
参考部署手册。

### 2.2 首次运行
1. 运行程序
2. 授予管理员权限
3. 开始使用

## 3. GUI 使用指南

### 3.1 主界面介绍

```
┌─────────────────────────────────────────┐
│ Mysysenv - 系统环境管理器               │
├──────┬──────────────────────────────────┤
│      │                                  │
│Python│  版本管理                        │
│Java  │                                  │
│Node  │  已安装版本:                     │
│Maven │  ✓ 3.11.4  (当前)  [卸载]      │
│Gradle│    3.10.12          [切换]      │
│      │    3.9.13           [切换]      │
│[+添加]│                                  │
│      │  下载新版本:                     │
│      │  版本: [3.12.0 ▼]  [下载]      │
└──────┴──────────────────────────────────┘
```

### 3.2 添加工具

1. 点击侧边栏底部的"+ 添加"按钮
2. 输入工具名称（如 python、java 等）
3. 点击"确定"
4. 工具会自动添加到侧边栏

### 3.3 配置工具

1. 在侧边栏选择要配置的工具
2. 切换到"配置"标签页
3. 配置以下内容：
   - 工具根目录：工具安装的根路径
   - 镜像源列表：下载镜像源
   - 版本检测命令：检测版本的命令
   - 环境变量配置：HOME 变量名和 PATH 条目
4. 点击"保存"

### 3.4 安装版本

1. 在侧边栏选择工具
2. 切换到"版本"标签页
3. 在"下载新版本"区域选择版本
4. 点击"下载"
5. 等待下载完成

### 3.5 切换版本

1. 在侧边栏选择工具
2. 切换到"版本"标签页
3. 在"已安装版本"列表中找到要切换的版本
4. 点击"切换"按钮
5. 重启终端使环境变量生效

### 3.6 卸载版本

1. 在侧边栏选择工具
2. 切换到"版本"标签页
3. 在"已安装版本"列表中找到要卸载的版本
4. 点击"卸载"按钮
5. 确认卸载

注意：不能卸载当前正在使用的版本。

### 3.7 删除工具

1. 在侧边栏右键点击要删除的工具
2. 选择"删除工具"
3. 确认删除

## 4. CLI 使用指南

### 4.1 命令概览

```
mse [options] <command> [args]
```

### 4.2 查看帮助

```bash
# 查看总体帮助
mse --help

# 查看命令帮助
mse list --help
mse use --help
```

### 4.3 列出工具

```bash
# 列出所有已配置的工具
mse tools
```

### 4.4 列出版本

```bash
# 列出 Python 的已安装版本
mse list python

# 列出 Python 的远程可用版本
mse list python --remote

# JSON 格式输出
mse list python --format json
```

### 4.5 切换版本

```bash
# 切换到 Python 3.10.12
mse use python 3.10.12
```

注意：切换后需要重启终端才能生效。

### 4.6 安装版本

```bash
# 安装 Python 3.12.0
mse install python 3.12.0
```

### 4.7 卸载版本

```bash
# 卸载 Python 3.9.13
mse uninstall python 3.9.13
```

### 4.8 设置根目录

```bash
# 查看 Python 的根目录
mse root python

# 设置 Python 的根目录
mse root python D:\Tools\Python
```

### 4.9 管理配置

```bash
# 查看当前配置
mse config

# 设置配置值
mse config --set settings.download_retry_count=5

# 在编辑器中打开配置
mse config --edit
```

## 5. 预配置工具

### 5.1 Python
- 默认镜像源：官方源、华为云、阿里云
- 环境变量：PYTHON_HOME
- PATH 条目：根目录、Scripts

### 5.2 Java
- 默认镜像源：华为云 OpenJDK
- 环境变量：JAVA_HOME
- PATH 条目：bin

### 5.3 其他工具
可以通过配置面板添加 Node.js、Maven、Gradle 等工具。

## 6. 配置说明

### 6.1 工具根目录
工具版本安装的根路径，例如：
```
D:\Tools\Python\
├── 3.11.4\
├── 3.10.12\
└── 3.9.13\
```

### 6.2 镜像源列表
用于下载工具的镜像源，按顺序尝试。

### 6.3 版本检测命令
用于检测工具版本的命令。

### 6.4 环境变量配置
- HOME 变量：工具的主目录环境变量
- PATH 条目：要添加到 PATH 的子目录

## 7. 常见问题

### 7.1 切换版本后不生效

**问题**：切换版本后，工具版本没有变化

**解决**：
- 重启终端或 IDE
- 或重新登录系统

### 7.2 下载失败

**问题**：下载版本时失败

**解决**：
- 检查网络连接
- 尝试更换镜像源
- 检查防火墙设置

### 7.3 权限不足

**问题**：提示权限不足

**解决**：
- 以管理员身份运行程序
- 或将工具根目录设置到用户目录下

### 7.4 找不到已安装版本

**问题**：已手动安装的版本没有显示

**解决**：
- 确认版本目录在工具根目录下
- 点击"刷新"按钮
- 或检查目录名称是否符合版本格式

## 8. 高级用法

### 8.1 添加自定义工具

1. 点击"+ 添加"按钮
2. 输入工具名称
3. 在配置面板中填写：
   - 工具根目录
   - 镜像源（如需下载）
   - 版本检测命令
   - 环境变量规则
   - 版本获取配置（正则表达式等）
4. 保存配置

### 8.2 手动导入版本

1. 将版本目录放到工具根目录下
2. 确保目录名是版本号（如 3.11.4）
3. 刷新版本列表

### 8.3 备份配置

备份 EXE 所在目录下的 `config` 文件夹（或开发时的项目目录/config 文件夹）。

## 9. 快捷键

| 快捷键 | 功能 |
|--------|------|
| F5 | 刷新 |
| Ctrl+S | 保存配置 |
| Esc | 关闭对话框 |
