# 部署手册

## 1. 概述

本文档描述如何部署 Mysysenv 应用程序。

## 2. 系统要求

### 2.1 运行环境
- Windows 7 或更高版本
- 无需安装 Python（使用打包版本）

## 3. 部署方式

### 3.1 方式一：使用打包好的 EXE（推荐）

#### 3.1.1 下载
从发布页面下载 `mysysenv.exe`。

#### 3.1.2 安装
1. 将 `mysysenv.exe` 放到任意目录（建议 `C:\Program Files\Mysysenv\`）
2. （可选）将该目录添加到系统 PATH，以便在任意位置使用
3. 双击运行或从命令行运行

#### 3.1.3 首次运行
1. 首次运行时会请求管理员权限
2. 点击"是"授予权限
3. 在 EXE 所在目录下自动创建 `config` 文件夹

### 3.2 方式二：从源码运行

#### 3.2.1 环境准备
参考开发环境搭建指南。

#### 3.2.2 运行
```bash
# GUI 模式
python src/main.py

# CLI 模式
python src/main.py --help
```

## 4. 打包 EXE（开发者）

### 4.1 安装打包工具

```bash
pip install pyinstaller
```

### 4.2 打包命令

```bash
pyinstaller --onefile --windowed --name mysysenv src/main.py
```

参数说明：
- `--onefile`：打包成单个 EXE
- `--windowed`：不显示控制台窗口（GUI 模式）
- `--name mysysenv`：指定输出文件名

### 4.3 打包输出
打包完成后，EXE 文件位于 `dist/mysysenv.exe`。

## 5. 配置目录

### 5.1 配置目录位置
配置目录位于：
- **开发时**：项目根目录下的 `config` 文件夹
- **打包后**：EXE 文件所在目录下的 `config` 文件夹

### 5.2 目录结构
```
EXE所在目录/
└── config/
    ├── config.json          # 主配置文件
    ├── cache.json           # 缓存文件
    └── default_config.json  # 默认配置模板
```

## 6. 卸载

### 6.1 备份配置（可选）
备份 EXE 所在目录下的 `config` 文件夹。

### 6.2 删除程序文件
删除 `mysysenv.exe`。

### 6.3 删除配置（可选）
删除 EXE 所在目录下的 `config` 文件夹。

### 6.4 清理环境变量（可选）
手动删除工具相关的环境变量（如 PYTHON_HOME、JAVA_HOME 等）。

## 7. 常见问题

### 7.1 权限被拒绝

**问题**：运行时提示权限不足

**解决**：
- 右键点击 EXE，选择"以管理员身份运行"
- 或将程序放到不需要管理员权限的目录

### 7.2 配置文件丢失

**问题**：配置丢失或损坏

**解决**：
- 删除 EXE 所在目录下的 `config/config.json`
- 重新运行程序，会自动创建默认配置

### 7.3 杀毒软件拦截

**问题**：杀毒软件误报

**解决**：
- 将 `mysysenv.exe` 添加到信任列表
- 或临时关闭杀毒软件

## 8. 版本升级

### 8.1 升级步骤
1. 备份当前配置（可选）
2. 下载新版本 EXE
3. 替换旧版本 EXE
4. 运行新版本

### 8.2 兼容性
- 配置文件向后兼容
- 升级后无需重新配置

## 9. 安全建议

- 仅从官方来源下载
- 定期备份配置文件
- 不要在配置文件中存储敏感信息
